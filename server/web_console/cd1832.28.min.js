(window.webpackJsonp=window.webpackJsonp||[]).push([[28,64,65,90,91,114],{122:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),l=n(0),i=n.n(l),o=n(86),c=n.n(o),u=n(511),s=n.n(u),d="/data00/webprojectdev/hids_open/src/pages/alarm-list/alarm-overview/alarm-vuln-count-box/index.tsx";function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=c.a.bind(s.a);t.default=function(e){var t=e.title,n=e.count,r=e.containerStyle,a=e.util;return i.a.createElement("div",{className:p("container"),style:b({},r),__source:{fileName:d,lineNumber:17,columnNumber:5}},i.a.createElement("div",{className:p("title"),__source:{fileName:d,lineNumber:18,columnNumber:7}},t),i.a.createElement("div",{__source:{fileName:d,lineNumber:19,columnNumber:7}},i.a.createElement("span",{className:p("count"),__source:{fileName:d,lineNumber:20,columnNumber:9}},n>999?"999+":n),a))}},123:function(e,t,n){"use strict";n.r(t);var r=n(20),a=n.n(r),l=n(0),i=n.n(l),o=n(86),c=n.n(o),u=n(571),s=n(512),d=n.n(s),m="/data00/webprojectdev/hids_open/src/pages/alarm-list/alarm-overview/alarm-vuln-piechart/index.tsx",b=c.a.bind(d.a),p=function(e){var t=e.label,n=e.color,r=e.count;return i.a.createElement("div",{className:b("legend-box"),__source:{fileName:m,lineNumber:19,columnNumber:5}},i.a.createElement("div",{className:b("circle"),style:{background:n},__source:{fileName:m,lineNumber:20,columnNumber:7}}),i.a.createElement("div",{className:b("label"),__source:{fileName:m,lineNumber:21,columnNumber:7}},t),i.a.createElement("div",{className:b("count"),__source:{fileName:m,lineNumber:22,columnNumber:7}},r))};t.default=function(e){var t=e.value,n=Object(l.useState)({}),r=a()(n,2),o=r[0],c=r[1],s=null==t?void 0:t.map((function(e){return null==e?void 0:e.color})),d=Object(l.useMemo)((function(){var e=0;return null==t||t.forEach((function(t){var n;e+=null!==(n=null==t?void 0:t.count)&&void 0!==n?n:0})),e}),[t]);return Object(l.useEffect)((function(){c({tooltip:{trigger:"item",textStyle:{color:"#fff"},appendToBody:!0,backgroundColor:"#1d2129",formatter:function(){var e,n,r,a,l,i,o,c,u,s,m,b;return"<div>\n          <div style='display: flex;align-items: center'>\n              <div style='display: inline-block;width: 10px;height: 10px; border-radius: 50%;background: ".concat(null==t||null===(e=t[0])||void 0===e?void 0:e.color,";margin-right: 5px;'></div>\n              <div style='display: inline-block;width: 60px;'>").concat(null==t||null===(n=t[0])||void 0===n?void 0:n.label,"</div>\n              <div>").concat(((null==t||null===(r=t[0])||void 0===r?void 0:r.count)/(d||1)*100).toFixed(2),"%</div>\n          </div>\n          <div style='display: flex;align-items: center'>\n              <div style='display: inline-block;width: 10px;height: 10px; border-radius: 50%;background: ").concat(null==t||null===(a=t[1])||void 0===a?void 0:a.color,";margin-right: 5px;'></div>\n              <div style='display: inline-block;width: 60px;'>").concat(null==t||null===(l=t[1])||void 0===l?void 0:l.label,"</div>\n              <div>").concat(((null==t||null===(i=t[1])||void 0===i?void 0:i.count)/(d||1)*100).toFixed(2),"%</div>\n          </div>\n          <div style='display: flex;align-items: center'>\n              <div style='display: inline-block;width: 10px;height: 10px; border-radius: 50%;background: ").concat(null==t||null===(o=t[2])||void 0===o?void 0:o.color,";margin-right: 5px;'></div>\n              <div style='display: inline-block;width: 60px;'>").concat(null==t||null===(c=t[2])||void 0===c?void 0:c.label,"</div>\n              <div>").concat(((null==t||null===(u=t[2])||void 0===u?void 0:u.count)/(d||1)*100).toFixed(2),"%</div>\n          </div>\n          <div style='display: flex;align-items: center'>\n              <div style='display: inline-block;width: 10px;height: 10px; border-radius: 50%;background: ").concat(null==t||null===(s=t[3])||void 0===s?void 0:s.color,";margin-right: 5px;'></div>\n              <div style='display: inline-block;width: 60px;'>").concat(null==t||null===(m=t[3])||void 0===m?void 0:m.label,"</div>\n              <div>").concat(((null==t||null===(b=t[3])||void 0===b?void 0:b.count)/(d||1)*100).toFixed(2),"%</div>\n          </div>\n          </div>")}},color:d?s:new Array(4).fill("#F2F3F8"),series:[{type:"pie",radius:[20,24],label:{show:!1},emphasis:{scale:!1},labelLine:{show:!1},data:null==t?void 0:t.map((function(e){return{value:e.count,name:e.label,itemStyle:{borderColor:"#fff",borderWidth:1}}}))}]})}),[t]),i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{option:o,style:{height:48,width:48},__source:{fileName:m,lineNumber:109,columnNumber:7}}),i.a.createElement("div",{className:b("legend-out-box"),__source:{fileName:m,lineNumber:110,columnNumber:7}},null==t?void 0:t.map((function(e){return i.a.createElement(p,{label:e.label,color:e.color,count:e.count,key:e.label,__source:{fileName:m,lineNumber:112,columnNumber:11}})}))))}},163:function(e,t,n){"use strict";n.r(t);var r=n(41),a=n.n(r),l=n(20),i=n.n(l),o=n(26),c=n.n(o),u=n(0),s=n.n(u),d=n(86),m=n.n(d),b=n(122),p=n(123),v=n(551),f=n(562),h=n(552),y=n(535),N=n.n(y),g="/data00/webprojectdev/hids_open/src/pages/overview/risk-data/index.tsx",_=m.a.bind(N.a);t.default=function(){var e,t,n,r,l,o,d=Object(u.useState)(),m=i()(d,2),y=m[0],N=m[1];function x(){return(x=a()(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.GetAlarmStatistics)({params:void 0});case 2:t=e.sent,n=t.data,N(n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(u.useEffect)((function(){!function(){x.apply(this,arguments)}()}),[]),s.a.createElement(v.a,{containerStyle:{minHeight:148},contentStyle:{display:"flex",paddingTop:16},title:"风险数据",isCard:!0,__source:{fileName:g,lineNumber:32,columnNumber:5}},s.a.createElement("div",{className:_("content-box"),style:{flexBasis:360},__source:{fileName:g,lineNumber:40,columnNumber:7}},s.a.createElement(b.default,{title:"待处理告警",count:null!==(e=null==y?void 0:y.alarm_total)&&void 0!==e?e:0,containerStyle:{maxWidth:100,flexShrink:0},util:s.a.createElement(f.a,{onClick:function(){location.href="/alarm-list"},__source:{fileName:g,lineNumber:46,columnNumber:13}},"查看"),__source:{fileName:g,lineNumber:41,columnNumber:9}}),s.a.createElement("div",{style:{flexBasis:30},__source:{fileName:g,lineNumber:55,columnNumber:9}}),s.a.createElement("div",{className:_("chart-box"),__source:{fileName:g,lineNumber:56,columnNumber:9}},s.a.createElement(p.default,{value:[{count:null!==(t=null==y?void 0:y.alarm_critical_num)&&void 0!==t?t:0,color:"#E63F3F",label:"紧急"},{count:null!==(n=null==y?void 0:y.alarm_high_num)&&void 0!==n?n:0,color:"#846BCE",label:"高风险"},{count:null!==(r=null==y?void 0:y.alarm_medium_num)&&void 0!==r?r:0,color:"#FEC745",label:"中风险"},{count:null!==(l=null==y?void 0:y.alarm_low_num)&&void 0!==l?l:0,color:"#468DFF",label:"低风险"}],__source:{fileName:g,lineNumber:57,columnNumber:11}}))),s.a.createElement("div",{className:_("content-box"),style:{flexBasis:144},__source:{fileName:g,lineNumber:67,columnNumber:7}},s.a.createElement(b.default,{title:"累计处理的告警",count:null!==(o=null==y?void 0:y.alarm_processed_num)&&void 0!==o?o:0,__source:{fileName:g,lineNumber:68,columnNumber:9}})))}},511:function(e,t,n){e.exports={container:"container-0f45fb8e25",title:"title-ba84c9ae58",count:"count-1beebd5912"}},512:function(e,t,n){e.exports={"legend-out-box":"legend-out-box-6b72ecd301","legend-box":"legend-box-ce36834774",circle:"circle-c072094966",label:"label-c672ee3790",count:"count-5efbcf40d9"}},535:function(e,t,n){e.exports={"content-box":"content-box-179f5a8477","chart-box":"chart-box-ac03cb6a8d"}},551:function(e,t,n){"use strict";var r=n(4),a=n.n(r),l=n(0),i=n.n(l),o=n(86),c=n.n(o),u=n(564),s=n.n(u),d="/data00/webprojectdev/hids_open/src/components/common/content-box/index.tsx";function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=c.a.bind(s.a);t.a=function(e){var t=e.util,n=e.title,r=e.containerStyle,a=e.contentStyle,l=e.topBoxStyle,o=e.children,c=e.isCard;return i.a.createElement("div",{className:p("container",c&&"card"),style:b({},r),__source:{fileName:d,lineNumber:27,columnNumber:5}},n?i.a.createElement("div",{className:p("top-box"),style:b({},l),__source:{fileName:d,lineNumber:29,columnNumber:9}},i.a.createElement("div",{className:p("title"),__source:{fileName:d,lineNumber:30,columnNumber:11}},n),i.a.createElement("div",{__source:{fileName:d,lineNumber:31,columnNumber:11}},t)):null,i.a.createElement("div",{className:p("content-box"),style:b({},a),__source:{fileName:d,lineNumber:34,columnNumber:7}},o))}},552:function(e,t,n){"use strict";n.r(t),n.d(t,"AlarmType",(function(){return r})),n.d(t,"getDisplayAlarmType",(function(){return i})),n.d(t,"AlarmLevel",(function(){return a})),n.d(t,"GetAlarmList",(function(){return u})),n.d(t,"UpdateAlarmStatus",(function(){return s})),n.d(t,"GetAlarmStatistics",(function(){return d})),n.d(t,"GetAlarmDetail",(function(){return m})),n.d(t,"RangeType",(function(){return o})),n.d(t,"MatchType",(function(){return c})),n.d(t,"matchTypeOptions",(function(){return p})),n.d(t,"WhiteMatchField",(function(){return b})),n.d(t,"whiteMatchFieldOptions",(function(){return v})),n.d(t,"GetWhiteList",(function(){return f})),n.d(t,"AddWhiteList",(function(){return h})),n.d(t,"DeleteWhiteList",(function(){return y})),n.d(t,"GetAlarmRaw",(function(){return N}));var r,a,l=n(40);function i(e){switch(e){case r.bruteforce:return"暴力破解";case r.privilege_escalation:return"提权攻击";case r.persistent:return"后门驻留";case r.evasion:return"变形木马";case r.purpose:return"恶意破坏";case r.static_scan:return"静态检测";case r.killchain:return"杀伤链";default:return"-"}}!function(e){e.bruteforce="bruteforce",e.privilege_escalation="privilege_escalation",e.persistent="persistent",e.evasion="evasion",e.purpose="purpose",e.static_scan="static_scan",e.killchain="killchain"}(r||(r={})),function(e){e.critical="critical",e.high="high",e.medium="medium",e.low="low"}(a||(a={}));var o,c,u=function(e){var t=e.data,n=e.params;return Object(l.b)({method:"post",url:"/api/v6/alarm/list",data:t,params:n},"获取告警列表信息")},s=function(e){var t=e.data;return Object(l.b)({method:"post",url:"/api/v6/alarm/update",data:t},"更新告警处理状态",!0)},d=function(e){var t=e.params;return Object(l.b)({method:"get",url:"/api/v6/alarm/statistics",params:t},"获取告警统计数据")},m=function(e){var t=e.params;return Object(l.b)({method:"get",url:"/api/v6/alarm/get/".concat(t.alarm_id)},"获取告警详情")};!function(e){e[e.all=0]="all",e[e.self=1]="self"}(o||(o={})),function(e){e[e.equal=0]="equal",e[e.reg=1]="reg"}(c||(c={}));var b,p=[{label:"等于",value:c.equal},{label:"正则匹配",value:c.reg}];!function(e){e.argv="argv",e.pgid_argv="pgid_argv",e.exe="exe",e.sip="sip",e.dip="dip",e.pid_tree="pid_tree",e.ld_preload="ld_preload",e.ko_file="ko_file",e.module_name="module_name",e.exe_hash="exe_hash"}(b||(b={}));var v=[{label:"命令行",value:b.argv},{label:"组长命令行",value:b.pgid_argv},{label:"二进制",value:b.exe},{label:"来源IP",value:b.sip},{label:"目的IP",value:b.dip},{label:"进程链",value:b.pid_tree},{label:"运行时链接",value:b.ld_preload},{label:"内核模块文件",value:b.ko_file},{label:"内核模块名",value:b.module_name},{label:"文件指纹",value:b.exe_hash}],f=function(e){var t=e.data,n=e.params;return Object(l.b)({method:"post",url:"/api/v6/whitelist/list",data:t,params:n},"获取白名单列表信息")},h=function(e){var t=e.data;return Object(l.b)({method:"post",url:"/api/v6/whitelist/add",data:t},"新增白名单",!0)},y=function(e){var t=e.data;return Object(l.b)({method:"post",url:"/api/v6/whitelist/del",data:t},"删除白名单",!0)},N=function(e){var t=e.params;return Object(l.b)({method:"get",url:"/api/v6/alarm/raw/".concat(t.alarm_id)},"获取告警原始数据")}},560:function(e,t,n){"use strict";n(13),n(570)},561:function(e,t,n){"use strict";var r=n(0),a=n.n(r),l=n(5),i=n.n(l),o=n(4),c=n.n(o),u=n(6);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){var n=Object(r.useContext)(u.a).prefixCls,l=e.spin,o=e.className,c=d(d({ref:t},e),{},{className:"".concat(o?o+" ":"").concat(n,"-icon ").concat(n,"-icon-link")});return l&&(c.className="".concat(c.className," ").concat(n,"-icon-loading")),delete c.spin,delete c.isIcon,a.a.createElement("svg",i()({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",width:"1em",height:"1em"},c),a.a.createElement("path",{d:"m14.1 25.414-4.95 4.95a6 6 0 0 0 8.486 8.485l8.485-8.485a6 6 0 0 0 0-8.485m7.779.707 4.95-4.95a6 6 0 1 0-8.486-8.485l-8.485 8.485a6 6 0 0 0 0 8.485"}))}var b=a.a.forwardRef(m);b.defaultProps={isIcon:!0},b.displayName="IconLink";var p=b,v=n(1),f=n(3),h=n(7),y=function(){return(y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},N=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},g={hoverable:!0};var _=Object(r.forwardRef)((function(e,t){var n,l=Object(r.useContext)(f.a),i=l.getPrefixCls,o=l.componentConfig,c=Object(h.a)(e,g,null==o?void 0:o.Link),u=c.className,s=c.style,d=c.children,m=c.icon,b=c.status,_=c.disabled,x=c.hoverable,O=N(c,["className","style","children","icon","status","disabled","hoverable"]),w=i("link"),j="href"in c?"a":"span";return a.a.createElement(j,y({className:Object(v.a)(w,(n={},n[w+"-disabled"]=_,n[w+"-is-"+b]=b,n[w+"-with-icon"]=m,n[w+"-hoverless"]=!x,n),u),ref:t},O,{style:s,onClick:function(e){_?(e.preventDefault(),e.stopPropagation()):c.onClick&&c.onClick(e)}}),m?a.a.createElement("span",{className:w+"-icon"},!0===m?a.a.createElement(p,null):m):null,d)}));_.displayName="Link";t.a=_},562:function(e,t,n){"use strict";n(560);var r=n(561),a=n(5),l=n.n(a),i=n(0),o=n.n(i);t.a=function(e){var t=l()({},e);return o.a.createElement(r.a,l()({style:{padding:"0 8px"}},t,{__source:{fileName:"/data00/webprojectdev/hids_open/src/components/common/text-button/index.tsx",lineNumber:7,columnNumber:10}}))}},564:function(e,t,n){e.exports={container:"container-ff5344dbc2","top-box":"top-box-0ebc1e6648",title:"title-1f92f6896d","content-box":"content-box-518d5e101b",card:"card-3d582462db"}},570:function(e,t,n){}}]);